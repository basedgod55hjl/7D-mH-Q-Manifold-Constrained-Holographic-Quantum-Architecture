// 7D Translated Source
// Generated by 7D Rewrite Engine v1.0
// Sovereignty: ENABLED

#pragma once
#include <NvInfer.h>
#include <vector>
#include <string>
#include "poincare_projection_plugin.h"
#include "hcl_encode_plugin.h"
#include "s2_stabilize_plugin.h"

namespace tensorrt_llm::builder {

class EngineBuilder {
public:
    EngineBuilder(nvinfer1::ILogger& logger);
    ~EngineBuilder() = default;

    // Registers all 7D mH-Q custom plugins with the registry
    static void registerPlugins();

    // Builds the engine specifically for the 7D mH-Q architecture
    // This is a specialized builder that assumes the specific network topology
    // In a full LLM scenario, this would take a network definition, but here
    // we hardcode the "Crystal" structure for the prototype.
    nvinfer1::ICudaEngine* buildCrystalEngine(
        const std::string& modelPath,
        int maxBatchSize,
        int maxSeqLen
    );

private:
    nvinfer1::ILogger& mLogger;
};

} // namespace tensorrt_llm::builder
